var id=randomId();var socket=io.connect("http://vagnersantana.com:8080");var media=document.getElementById("player");socket.emit("setId",id);socket.on("play",function(f){var c=$(".playlist-ul li");console.log(f);if(f.action==="play"){media.play()}else{if(f.action==="pause"){media.pause()}else{if(f.action==="fullscreen"){fullScreenToggle()}else{if(f.action==="volup"){media.volume+=0.1}else{if(f.action==="voldown"){media.volume-=0.1}else{if(f.action==="prev"){var b;$.each(c,function(){if($(this).hasClass("nowplay")){if($(this).prev()!==undefined){b=$(this).prev().attr("data-fileid")}}});getMedia(b)}else{if(f.action==="next"){var a;$.each(c,function(){if($(this).hasClass("nowplay")){if($(this).next()!==undefined){a=$(this).next().attr("data-fileid")}}});getMedia(a)}else{if(f.action==="seek"){var e=media.duration;var d=(e*f.val)/100;media.currentTime=d}else{if(f.action==="change"){getMedia(f.val)}else{if(f.action==="playlist"){getPlaylist()}}}}}}}}}}});function sendPlaylist(b){var a=[];a.push({id:id+"mb"});a.push({pl:b});socket.emit("setPlaylist",a)}$("#qr").html('<a href="http://vagnersantana.com:8080/mb/'+id+'" target="_blank"><img src="https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl=http://vagnersantana.com:8080/mb/'+id+'&choe=UTF-8" alt="QR Code" /></a>');function randomId(){var a="";var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var b=0;b<5;b++){a+=c.charAt(Math.floor(Math.random()*c.length))}return a}(function localFileVideoPlayerInit(e){var a=e.URL||e.webkitURL,d=function c(f){var h=this.files[0];var q=(this.files.length);for(var l=0;l<q;l++){var g=this.files[l];var o=g.type;var j=document.querySelector("video");var m=j.canPlayType(o);m=(m===""?"no":m);var n=m==="no";var p="";if(m=="no"){if(!o){o=g.name.slice(g.name.lastIndexOf(".")+1)}p='Unable to play file type: "'+o+'"';displayMessage(p,n)}else{p="";displayMessage(p)}if(n){return}else{var k=a.createObjectURL(g);$(".no").remove();addToPlayList(k,g.name);getPlaylist()}}$("#fileinp").val("")},b=document.querySelector("input");if(!a){displayMessage('Your browser is not <a href="http://caniuse.com/bloburls">supported</a>!',true);return}b.addEventListener("change",d,false)}(window));$("#add").on("click",function(){var a=$("#mediaurl").val();$("#mediaurl").val(null);if(a!=""){$(".no").remove();addToPlayList(a);getPlaylist()}else{alert("Insert a URL for a file")}});$(".playlist-ul").on("click","li",function(){playMedia($(this))});function addToPlayList(b,a){if(!a){var a=b.slice(b.lastIndexOf("/")+1)}var c=b.type?'data-type="'+b.type+'" ':"";$(".playlist-ul").append('<li data-file="'+b+'" data-fileid="'+randomId()+'" data-filename="'+a+'" class="playlist-li" '+c+">"+a+"</li>")}function displayMessage(b,a){$("#message").html(b);$("#message").get(0).className=a?"error":"info"}function getPlaylist(){var b=$(".playlist-ul li"),a=[],c;$.each(b,function(){c=$(this).attr("data-fileid");filename=$(this).attr("data-filename");a.push({file:c,fileName:filename})});if(a.length){sendPlaylist(a)}}function getMedia(b){var a=$(".playlist-ul li");$.each(a,function(){if($(this).attr("data-fileid")==b){playMedia($(this))}})}function playMedia(a){$(".playlist-ul li").removeClass("nowplay");$("#player").attr({src:a.attr("data-file")});$("#player").get(0).play();a.addClass("nowplay");displayMessage("");setTimeout(checkVideoDuration,100)}function checkVideoDuration(){var a=$("#player").get(0).duration;if(a<=0||isNaN(a)){message="Unable to play this file.";displayMessage(message,"error")}}function fullScreenToggle(){var b=$(window).width(),a=$(window).height();if(!$("video").hasClass("fullScreen")){$("video").addClass("fullScreen");$("video").css({width:b,height:a})}else{$("video").removeClass("fullScreen");$("video").css({width:"800px",height:"480px"})}};